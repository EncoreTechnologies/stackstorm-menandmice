version: '2.0'

menandmice.test_credentials:
  description: >
    Test the credentials to login to Men&Mice
  type: direct
  input:
    - connection
    - server
    - username
    - password
    - port
    - transport

  output:
    result: "{{ _.result }}"
    data:
      server: "{{ _.server }}"
      username: "{{ _.username }}"
  output-on-error:
    result: "{{ _.result }}"
    data:
      server: "{{ _.server }}"
      username: "{{ _.username }}"

  tasks:
    main:
      action: menandmice.login
      input:
        connection: "{{ _.connection }}"
        server: "{{ _.server }}"
        username: "{{ _.username }}"
        password: "{{ _.password }}"
        port: "{{ _.port }}"
        transport: "{{ _.transport }}"
      publish:
        result: "{{ task('main').result }}"
      publish-on-error:
        result: "{{ task('main').result }}"
